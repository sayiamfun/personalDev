webpackJsonp([18],{"+IKU":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("T452"),i={name:"newAddGroupSend",data:function(){return{title:"",agree:!1,reContentVal:[{content:"",contentType:"文字"}],loading:!1,sendTiems:"立即发送",groupNei:"群发送",yulanEWM:!1,Dshow:!1,dada1:"",titi1:"",upLoadVal:"",upLoadVals:"",replayNeiRong:"",editDate2:"",editTimeXuan2:"",src:"",srcs:"",mingCard:"",addLinks:""}},inject:["reload"],created:function(){this.title=this.$route.query.title},methods:{editSelectDate:function(e){console.log(e);var t=new Date(e),s=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var i=t.getDate()<10?"0"+t.getDate():t.getDate();console.log(s+"-"+n+"-"+i),this.dada1=s+"-"+n+"-"+i},editSelectTimes:function(e){console.log(e);var t=new Date(e),s=t.getHours()<10?"0"+t.getHours():t.getHours(),n=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),i=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();console.log(s+":"+n+":"+i),this.titi1=s+":"+n+":"+i},timeChange:function(e){console.log(e),this.sendTiems=e,"定时发送"===e?this.Dshow=!0:(this.Dshow=!1,this.dada1="",this.titi1="")},getFile:function(e){var t=this,s=e.target.files[0];if(this.upLoadVal=s.name,console.log(this.$refs.file),e&&window.FileReader){var i=new FileReader;i.readAsDataURL(s),i.onloadend=function(){var e=this;t.src=this.result,console.log(t.src),t.$http.post(n.d+"/upload/imageUpload",t.src).then(function(s){console.log(s),s.body.code===n.a?e.$message({type:"error",message:"图片上传"+s.body.message}):(t.registerAvatar=s.body.data,t.$set(t.reContentVal,t.indexTime,{content:s.body.data,contentType:"图片"}))})},console.log(t.reContentVal)}},uploadImgs:function(e){console.log(e),this.indexTime=e},yulan:function(e){console.log(e),this.yulanEWM=!this.yulanEWM},inputChange:function(e,t,s){console.log(s),this.$set(this.reContentVal,s,{content:t,contentType:"文字"})},word:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"文字"}),this.$refs.newBottom.style.paddingTop=n.c+"px",this.$refs.newBottom.style.paddingBottom=n.c+"px"},busCard:function(){},showImg:function(){this.closeIgs=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"图片"})},link:function(){},close:function(e){this.closeShow=!this.closeShow,this.reContentVal.splice(e,1),this.$refs.newBottom.style.paddingTop=n.a+"px",this.$refs.newBottom.style.paddingBottom=n.a+"px"},closeCard:function(){},closeImg:function(){},closeLink:function(){},send:function(){var e=this,t={personaNoTaskId:this.$route.query.id,personalNoTaskMessageName:this.$route.query.title,personalNoTaskMessageSendContentList:this.reContentVal,sendTime:this.dada1+" "+this.titi1};this.$http.post(n.d+"/personalNoTaskMessageSend/taskMessageSend",t).then(function(t){console.log(t),t.body.code===n.a?e.$message({type:"error",message:t.body.message}):(e.$message({type:"success",message:t.body.message}),setTimeout(function(){e.$router.push({path:"/personalTask"})},1e3))})},sendCancel:function(){this.$router.push({path:"/personalTask"}),this.reload()}}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"taskMessage"},[n("div",{staticClass:"adver-set"},[e._v("新增消息")]),e._v(" "),n("div",{staticClass:"adverWrapper"},[n("div",{staticClass:"adverBorder"},[n("el-form",{staticClass:"form"},[n("div",{staticClass:"send-wrapper"},[n("el-form-item",{attrs:{label:"群发任务:","label-width":"100px"}},[n("span",[e._v(e._s(e.title))])])],1),e._v(" "),n("div",{staticClass:"sendTs"},[n("el-form-item",{attrs:{label:"时间设置:"}},[n("el-radio-group",{on:{change:e.timeChange},model:{value:e.sendTiems,callback:function(t){e.sendTiems=t},expression:"sendTiems"}},[n("el-radio",{attrs:{label:"立即发送"}},[e._v("立即发送")]),e._v(" "),n("el-radio",{attrs:{label:"定时发送"}},[e._v("定时发送")])],1)],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.Dshow,expression:"Dshow"}]},[n("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:e.editSelectDate},model:{value:e.editDate2,callback:function(t){e.editDate2=t},expression:"editDate2"}}),e._v(" "),n("el-time-picker",{attrs:{format:"HH:mm:ss",placeholder:"选择时间"},on:{change:e.editSelectTimes},model:{value:e.editTimeXuan2,callback:function(t){e.editTimeXuan2=t},expression:"editTimeXuan2"}})],1)],1),e._v(" "),n("div",{staticClass:"groupSendC"},[n("el-form-item",{attrs:{label:"发送内容:","label-width":"200"}},[n("div",{staticClass:"newBigCon"},[n("div",{staticClass:"newTop"},[n("ul",[n("li",{staticStyle:{width:"105px"},on:{click:e.word}},[e._v("文字")]),e._v(" "),n("li",{on:{click:e.busCard}},[e._v("名片")]),e._v(" "),n("li",{on:{click:e.showImg}},[e._v("图片")]),e._v(" "),n("li",{on:{click:e.link}},[e._v("链接")])])]),e._v(" "),n("div",{ref:"newBottom",staticClass:"newBottom"},[e._l(e.reContentVal,function(t,s){return n("div",{key:s},["文字"===t.contentType?n("div",{ref:"word",refInFor:!0,staticClass:"newWords"},[n("i",{staticClass:"el-icon-edit"}),e._v(" "),n("el-input",{attrs:{value:t.content,type:"textarea",maxlength:"800",autosize:{minRows:2,maxRows:4},placeholder:"请输入回复内容，不得超过800字。添加“#####”可在回复时@对应成员。"},on:{change:function(n){return e.inputChange(t,n,s)}}}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"图片"===t.contentType?n("div",{ref:"image",refInFor:!0,staticClass:"newImg"},[n("i",{staticClass:"el-icon-picture-outline"}),e._v(" "),n("div",{staticClass:"uploadImg"},[n("input",{ref:"file",refInFor:!0,attrs:{type:"file",id:"file"},on:{change:function(t){return e.getFile(t)}}}),e._v(" "),n("label",{staticClass:"upload",attrs:{for:"file"},on:{click:function(t){return e.uploadImgs(s)}}},[e._v("上传文件")]),e._v(" "),n("label",{staticClass:"yulan",on:{click:function(s){return e.yulan(t.content)}}},[e._v("预览")])]),e._v(" "),n("el-dialog",{attrs:{visible:e.yulanEWM,width:"20%","append-to-body":""},on:{"update:visible":function(t){e.yulanEWM=t}}},[n("img",{staticClass:"imgWEM",attrs:{src:t.content}})]),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e()])}),e._v(" "),n("div",{staticClass:"fission"}),e._v(" "),n("span",{staticStyle:{color:"red"}},[e._v("每次发送不能超过5条消息")])],2)])])],1),e._v(" "),n("div",{staticClass:"submit"},[n("el-button",{staticClass:"subSpa1",attrs:{disabled:e.agree},on:{click:e.send}},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticStyle:{width:"16px",height:"16px","vertical-align":"middle"},attrs:{src:s("G/2H")}}),e._v("\n            发 送")]),e._v(" "),n("el-button",{staticClass:"subSpa2",on:{click:e.sendCancel}},[e._v("取 消")])],1)])],1)])])},staticRenderFns:[]};var o=s("C7Lr")(i,a,!1,function(e){s("eyax"),s("fojE")},"data-v-19c50881",null);t.default=o.exports},eyax:function(e,t){},fojE:function(e,t){}});