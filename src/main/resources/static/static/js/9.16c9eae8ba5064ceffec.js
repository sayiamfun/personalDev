webpackJsonp([9],{"5zt3":function(e,t){},Fq6j:function(e,t){},"N+zk":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("IHPB"),o=n.n(s),a=n("T452"),i=n("Y8t/"),r={name:"addPersonalMessage",data:function(){return{groupV:"",groupCategorySet:[],groupCategory:[],groupSet:"",relapyContentCategoryName:"",yulanEWM1:!1,registerAvatar:"",src:"",tuName:"",dragging:[],goP:!0,messageName:"",fssion:"",fssionIndex:0,fssionList:[{id:0,name:"1号后台"},{id:1,name:"2号后台"}],reContentVal:[{content:"",contentType:"文字"}]}},created:function(){var e=this;if(1===this.$route.query.error){Object(i.c)("/personalNoMessage/"+this.$route.query.id+"/",{}).then(function(t){if(console.log(t),t.code===a.a)e.$message({type:"error",message:t.message});else{e.reContentVal=t.data.messageContentList,e.relapyContentCategoryName=t.data.groupName,e.messageName=t.data.keyword,console.log(e.reContentVal);for(var n=0;n<e.reContentVal.length;n++)"邀请入群"===e.reContentVal[n].contentType?e.goP=!1:e.goP=!0}}).catch(function(t){e.$message({type:"error",message:t.message})})}else this.goP=!0},methods:{uploadVoiceValShow:function(e,t){this.$set(this.reContentVal,t,{content:e,contentType:"语音消息"})},inputChangeLittle:function(e,t,n){console.log(n),this.$set(this.reContentVal,n,{content:t,contentType:"小程序"})},selectGroup:function(e,t){console.log(e),console.log(t);var n=e;this.$set(this.reContentVal,t,{content:this.fssionIndex+"/"+n,contentType:"邀请入群"})},selectGroupSet:function(e){var t=this;console.log(e),Object(i.b)("/groupCategory/"+e+"/"+this.fssionIndex+"/").then(function(e){console.log(e),e.code===a.a?t.$message({type:"error",message:"暂时没有群类别哦，创建一个群类别再来添加群哦"}):t.groupCategory=e.data}).catch(function(e){t.$message({type:"error",message:e.message})})},getFile1:function(e){var t=this,n=e.target.files[0];if(console.log(this.$refs.file),this.tuName=n.name,e&&window.FileReader){var s=new FileReader;s.readAsDataURL(n),s.onloadend=function(){var e=this;t.src=this.result,t.$message({showClose:!0,message:"图片压缩中.....",duration:0}),Object(i.c)("/upload/imageUpload",t.src).then(function(n){console.log(n),n.code===a.a?e.$message({type:"error",message:"图片上传"+n.message}):(t.$message.closeAll(),t.$message({type:"success",message:"图片上传成功"}),t.registerAvatar=n.data,t.$set(t.reContentVal,t.indexTime,{content:n.data,contentType:"图片"}))}).catch(function(t){e.$message({type:"error",message:t.message})})}}},uploadImgs1:function(e){console.log(e)},yulan1:function(e,t){this.yulanEWM1=!this.yulanEWM1},fssionChange:function(e){var t=this;0===e?(this.fssionIndex=0,this.fssion="1号后台"):(this.fssionIndex=1,this.fssion="2号后台"),Object(i.b)("/groupCategorySet/"+this.fssionIndex+"/").then(function(e){console.log(e),e.code===a.a?t.$message({type:"error",message:"暂时没有可用的群哦"}):t.groupCategorySet=e.data}).catch(function(e){t.$message({type:"error",message:e.message})})},word:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"文字"}),this.$refs.newBottom.style.paddingTop=a.b+"px",this.$refs.newBottom.style.paddingBottom=a.b+"px"},showImg:function(){this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"图片"})},music:function(){if(this.groupCategorySet.length<=0)this.$message({type:"error",message:"请先选择裂变后台，再来添加入群邀请"});else{for(var e=0,t=0;t<this.reContentVal.length;t++)console.log(this.reContentVal[t].contentType),"邀请入群"===this.reContentVal[t].contentType&&(e+=1),console.log(e);e>=1?this.$message({type:"error",message:"邀请入群只能添加一个"}):(this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"邀请入群"}),this.$refs.newBottom.style.paddingTop=a.b+"px",this.$refs.newBottom.style.paddingBottom=a.b+"px")}},miniPro:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"小程序"}),this.$refs.newBottom.style.paddingTop=a.b+"px",this.$refs.newBottom.style.paddingBottom=a.b+"px"},voiceInfo:function(){this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"语音消息"})},handleDragStart:function(e,t){console.log(e),console.log(t),this.dragging=t,console.log(this.dragging)},handleDragEnd:function(e,t){console.log(e),console.log(t),this.dragging=null},handleDragOver:function(e){console.log(e),e.dataTransfer.dropEffect="move"},handleDragEnter:function(e,t){if(console.log(e),console.log(t),e.dataTransfer.effectAllowed="move",t!==this.dragging){var n=[].concat(o()(this.reContentVal));console.log(n);var s=n.indexOf(this.dragging),a=n.indexOf(t);n.splice.apply(n,[a,0].concat(o()(n.splice(s,1)))),this.reContentVal=n}},inputChange:function(e,t,n){console.log(n),this.$set(this.reContentVal,n,{content:t,contentType:"文字"})},close:function(e){this.closeShow=!this.closeShow,this.reContentVal.splice(e,1),this.$refs.newBottom.style.paddingTop=a.a+"px",this.$refs.newBottom.style.paddingBottom=a.a+"px"},sureSubmit:function(){var e=this,t={};t=0===this.$route.query.error?{messageContentList:this.reContentVal,keyword:this.messageName}:{id:this.$route.query.id,messageContentList:this.reContentVal,keyword:this.messageName},Object(i.c)("/personalNoMessage/addMessage",t).then(function(t){console.log(t),t.code===a.a?e.$message({type:"error",message:t.message}):(e.$message({type:"success",message:t.message}),setTimeout(function(){e.$router.push({path:"/personalMessage"})},1e3))}).catch(function(t){e.$message({type:"error",message:t.message})})},keyCancel:function(){this.$router.push({path:"/personalMessage"})}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"addPersonalMessage"},[n("el-form",[n("el-form-item",{attrs:{label:"消息名称：","label-width":"150px"}},[n("el-input",{staticStyle:{width:"20%"},attrs:{placeholder:"请输入消息名称..."},model:{value:e.messageName,callback:function(t){e.messageName=t},expression:"messageName"}})],1),e._v(" "),n("div",{staticClass:"invateGoGroup"},[n("el-form-item",{attrs:{label:"群裂变后台：","label-width":"150px"}},[n("el-select",{staticStyle:{width:"20%"},attrs:{placeholder:"请选择裂变后台"},on:{change:e.fssionChange},model:{value:e.fssion,callback:function(t){e.fssion=t},expression:"fssion"}},e._l(e.fssionList,function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),n("p",{staticStyle:{color:"red"}},[e._v("*仅限邀请入群选择")])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"回复内容：","label-width":"150px"}},[n("span",{staticStyle:{color:"red","font-size":"12px"}},[e._v("*确保你选择的个人号在你选择的群里(仅针对邀请入群)")]),e._v(" "),n("div",{staticClass:"newBigCon"},[n("div",{staticClass:"newTop"},[n("ul",[n("li",{staticStyle:{width:"105px"},on:{click:e.word}},[e._v("文字")]),e._v(" "),n("li",{on:{click:e.showImg}},[e._v("图片")]),e._v(" "),n("li",{on:{click:e.music}},[e._v("邀请入群")]),e._v(" "),n("li",{on:{click:e.miniPro}},[e._v("小程序")]),e._v(" "),n("li",{on:{click:e.voiceInfo}},[e._v("语音消息")])])]),e._v(" "),n("div",{ref:"newBottom",staticClass:"newBottom"},[e._l(e.reContentVal,function(t,s){return n("div",{key:s,attrs:{draggable:"true"},on:{dragstart:function(n){return e.handleDragStart(n,t)},dragover:function(n){return n.preventDefault(),e.handleDragOver(n,t)},dragenter:function(n){return e.handleDragEnter(n,t)},dragend:function(n){return e.handleDragEnd(n,t)}}},["文字"===t.contentType?n("div",{ref:"word",refInFor:!0,staticClass:"newWords"},[n("i",{staticClass:"el-icon-edit"}),e._v(" "),n("el-input",{attrs:{type:"textarea",maxlength:"800",autosize:{minRows:8,maxRows:14},placeholder:"请输入回复内容，不得超过800字。添加“#####”可在回复时@对应成员。"},on:{change:function(n){return e.inputChange(t,n,s)}},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"item.content"}}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"图片"===t.contentType?n("div",{ref:"image",refInFor:!0,staticClass:"newImg"},[n("i",{staticClass:"el-icon-picture-outline"}),e._v(" "),n("div",{staticClass:"uploadImg"},[t.content?n("span",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[e._v(e._s(t.content))]):n("span",[e._v(e._s(e.tuName))]),e._v(" "),n("input",{ref:"file",refInFor:!0,attrs:{type:"file",id:"file1"},on:{change:function(t){return e.getFile1(t)}}}),e._v(" "),n("label",{staticClass:"upload",attrs:{for:"file1"},on:{click:function(t){return e.uploadImgs1(s)}}},[e._v("上传文件")]),e._v(" "),n("label",{staticClass:"yulan",on:{click:function(n){return e.yulan1(t.content,s)}}},[e._v("预览")])]),e._v(" "),n("el-dialog",{attrs:{visible:e.yulanEWM1,width:"20%","append-to-body":""},on:{"update:visible":function(t){e.yulanEWM1=t}}},[n("img",{staticClass:"imgWEM",attrs:{src:t.content}})]),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.goP,expression:"goP === false"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?n("span",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[n("i",{staticClass:"iconfont icon-yonghu-tianchong",staticStyle:{"padding-right":"10px"}}),e._v(e._s(e.relapyContentCategoryName))]):e._e()]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.goP,expression:"goP"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?n("div",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[n("i",{staticClass:"iconfont icon-yonghu-tianchong"}),e._v(" "),n("div",{staticClass:"groupList",staticStyle:{"margin-left":"20px"}},[n("el-select",{attrs:{placeholder:"请选择群类别集合"},on:{change:e.selectGroupSet},model:{value:e.groupSet,callback:function(t){e.groupSet=t},expression:"groupSet"}},e._l(e.groupCategorySet,function(e){return n("el-option",{key:e.sname,attrs:{label:e.sname,value:e.id}})}),1),e._v(" "),n("el-select",{attrs:{placeholder:"请选择群类别集合"},on:{change:function(t){return e.selectGroup(t,s)}},model:{value:e.groupV,callback:function(t){e.groupV=t},expression:"groupV"}},e._l(e.groupCategory,function(e){return n("el-option",{key:e.cname,attrs:{label:e.cname,value:e.id}})}),1)],1),e._v(" "),n("div",{staticClass:"createGroupClass"}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})]):e._e()]),e._v(" "),"小程序"===t.contentType?n("div",{ref:"little",refInFor:!0,staticClass:"newWords little"},[n("i",{staticClass:"el-icon-edit"}),e._v(" "),n("el-input",{staticStyle:{border:"none"},attrs:{placeholder:"请输入小程序链接地址"},on:{change:function(n){return e.inputChangeLittle(t,n,s)}},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"item.content"}}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"语音消息"===t.contentType?n("div",{ref:"voice",refInFor:!0,staticClass:"newWords"},[n("i",{staticClass:"iconfont icon-yuyin"}),e._v(" "),n("div",{staticClass:"uploadVoice",staticStyle:{display:"flex","flex-direction":"row",width:"80%"}},[n("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入个人号转过来的链接..."},on:{change:function(n){return e.uploadVoiceValShow(t,n,s)}},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"item.content"}})],1),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",staticStyle:{right:"-20px"},on:{click:function(t){return e.close(s)}}})]):e._e()])}),e._v(" "),n("div",{staticClass:"fission"}),e._v(" "),n("span",{staticStyle:{color:"red"}},[e._v("拖动模块可变更排序 ")]),e._v(" "),n("span",{staticStyle:{color:"red"}},[e._v("每次发送不能超过5条消息")])],2)])])],1),e._v(" "),n("div",{staticClass:"footer"},[n("span",{staticClass:"faqi",on:{click:e.sureSubmit}},[e._v("保 存")]),e._v(" "),n("span",{staticClass:"quxiao",on:{click:e.keyCancel}},[e._v("取 消")])])],1)},staticRenderFns:[]};var c=n("C7Lr")(r,l,!1,function(e){n("Fq6j"),n("5zt3")},"data-v-752bb9e0",null);t.default=c.exports}});