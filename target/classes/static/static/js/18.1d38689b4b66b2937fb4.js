webpackJsonp([18],{"36Xe":function(e,t){},"BN+n":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("IHPB"),o=s.n(n),i=s("T452"),a=s("8EyE"),r=s("Y8t/"),l={name:"newAddGroupSend",data:function(){return{dragging:[],relapyContentCategoryName:"",stopAddGroup:!0,fssionIndex:0,fssionList:[{id:0,name:"1号后台"},{id:1,name:"2号后台"}],fssion:"",groupV:"",groupCategory:[],groupSet:"",groupCategorySet:[],goP:!1,startOrEndTime:"",agree:!1,reContentVal:[{content:"",contentType:"文字"}],loading:!1,selectProv1:"",provs:[],selectCity1:[],citys1:[],sendTiems:"立即发送",groupNei:"群发送",closeShow:!0,closeId:!1,closeIgs:!1,closeLinks:!1,checkedIn:!1,checkedAdd:!1,yulanEWM:!1,yulanEWMs:!1,Dshow:!1,dada1:"",titi1:"",upLoadVal:"",upLoadVals:"",replayNeiRong:"",editDate2:"",editTimeXuan2:"",src:"",srcs:"",startTime:"",endTime:"",mingCard:"",addLinks:""}},inject:["reload"],created:function(){var e=this;if(Object(r.b)("/personal/noTask").then(function(t){console.log(t),e.provs=t.data}),console.log(this.$route.query.error),2===this.$route.query.error?this.goP=!1:this.goP=!0,1===this.$route.query.error?this.stopAddGroup=!1:this.stopAddGroup=!0,2===this.$route.query.error||1===this.$route.query.error){Object(r.c)("/personalNoTaskMessageSend/"+this.$route.query.id+"/",{}).then(function(t){console.log(t);var s=t.data;if(e.reContentVal=t.data.personalNoTaskMessageSendContentList,e.selectProv1=s.personaNoTaskId,e.groupSetId=s.personaNoTaskId,console.log(s.sendTime),s.sendTime){e.Dshow=!0,e.sendTiems="定时发送",e.editDate2=s.sendTime,e.editTimeXuan2=s.sendTime;var n=s.sendTime.slice(0,10),o=s.sendTime.slice(10,-1);e.dada1=n,e.titi1=o,e.relapyContentCategoryName=s.categoryName1}else e.Dshow=!1,e.sendTiems="立即发送",e.dada1="",e.titi1=""})}},methods:{handleDragStart:function(e,t){console.log(e),console.log(t),this.dragging=t,console.log(this.dragging)},handleDragEnd:function(e,t){console.log(e),console.log(t),this.dragging=null},handleDragOver:function(e){console.log(e),e.dataTransfer.dropEffect="move"},handleDragEnter:function(e,t){if(console.log(e),console.log(t),e.dataTransfer.effectAllowed="move",t!==this.dragging){var s=[].concat(o()(this.reContentVal));console.log(s);var n=s.indexOf(this.dragging),i=s.indexOf(t);s.splice.apply(s,[i,0].concat(o()(s.splice(n,1)))),this.reContentVal=s}},fssionChange:function(e){var t=this;0===e?(this.fssionIndex=0,this.fssion="1号后台"):(this.fssionIndex=1,this.fssion="2号后台"),Object(r.b)("/groupCategorySet/"+this.fssionIndex+"/").then(function(e){console.log(e),e.code===i.a?t.$message({type:"error",message:"暂时没有可用的群哦"}):t.groupCategorySet=e.data})},selectGroupSet:function(e){var t=this;console.log(e),Object(r.b)("/groupCategory/"+e+"/"+this.fssionIndex+"/").then(function(e){console.log(e),e.code===i.a?t.$message({type:"error",message:"暂时没有群类别哦，创建一个群类别再来添加群哦"}):t.groupCategory=e.data})},selectGroup:function(e,t){console.log(e),console.log(t);var s=e;this.$set(this.reContentVal,t,{content:this.fssionIndex+"/"+s,contentType:"邀请入群"}),console.log(this.reContentVal)},inputChangeLittle:function(e,t,s){console.log(s),this.$set(this.reContentVal,s,{content:t,contentType:"小程序"})},uploadVoiceValShow:function(e,t){this.$set(this.reContentVal,t,{content:e,contentType:"语音消息"})},startEndTime:function(e){console.log(e),this.startTime=e[0],this.endTime=e[1]},editSelectDate:function(e){console.log(e);var t=new Date(e),s=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var o=t.getDate()<10?"0"+t.getDate():t.getDate();console.log(s+"-"+n+"-"+o),this.dada1=s+"-"+n+"-"+o},editSelectTimes:function(e){console.log(e);var t=new Date(e),s=t.getHours()<10?"0"+t.getHours():t.getHours(),n=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),o=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();console.log(s+":"+n+":"+o),this.titi1=s+":"+n+":"+o},getProv1:function(e){console.log("集合groupSetId:"+e),this.groupSetId=e},timeChange:function(e){console.log(e),"定时发送"===e?(this.Dshow=!0,this.sendTiems=e):(this.Dshow=!1,this.sendTiems=e,this.dada1="",this.titi1="")},getFile:function(e){var t=this,s=e.target.files[0];if(console.log(this.$refs.file),e&&window.FileReader){var n=new FileReader;n.readAsDataURL(s),n.onloadend=function(){var e=this;t.src=this.result,console.log(t.src),t.$message({showClose:!0,message:"图片压缩中.....",duration:0}),Object(r.c)("/upload/imageUpload",t.src).then(function(s){console.log(s),s.code===i.a?e.$message({type:"error",message:"图片上传"+s.message}):(t.$message.closeAll(),t.$message({type:"success",message:"图片上传成功"}),t.registerAvatar=s.data,t.$set(t.reContentVal,t.indexTime,{content:s.data,contentType:"图片"}))})},console.log(t.reContentVal)}},uploadImgs:function(e){console.log(e),this.indexTime=e},yulan:function(e,t){console.log(e),console.log(t),this.indexTime===t&&(this.showIig=e),this.yulanEWM=!this.yulanEWM},NeiSong:function(e){console.log(e),this.groupNei=e},inputChange:function(e,t,s){console.log(s),this.$set(this.reContentVal,s,{content:t,contentType:"文字"})},word:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"文字"}),this.$refs.newBottom.style.paddingTop=i.b+"px",this.$refs.newBottom.style.paddingBottom=i.b+"px"},busCard:function(){this.closeId=!0},showImg:function(){this.closeIgs=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"图片"})},music:function(){!1===this.stopAddGroup?this.$message({type:"error",message:"邀请入群只能为一个"}):(this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"邀请入群"}),this.$refs.newBottom.style.paddingTop=i.b+"px",this.$refs.newBottom.style.paddingBottom=i.b+"px")},miniPro:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"小程序"}),this.$refs.newBottom.style.paddingTop=i.b+"px",this.$refs.newBottom.style.paddingBottom=i.b+"px"},voiceInfo:function(){this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"语音消息"})},link:function(){this.closeLinks=!0},goGroup:function(){},close:function(e){this.closeShow=!this.closeShow,this.reContentVal.splice(e,1),this.$refs.newBottom.style.paddingTop=i.a+"px",this.$refs.newBottom.style.paddingBottom=i.a+"px"},closeCard:function(){this.closeId=!this.closeId},closeImg:function(){this.closeIgs=!this.closeIgs},closeLink:function(){this.closeLinks=!this.closeLinks},send:function(){var e,t=this;this.loading=!0,this.agree=!0;var s={};(e=""===this.dada1&&""===this.titi1?"":this.dada1+" "+this.titi1,2===this.$route.query.error)?s={id:this.$route.query.id,personaNoTaskId:this.groupSetId,personalNoTaskMessageSendContentList:this.reContentVal,sendTime:e,startTime:this.startTime,endTime:this.endTime}:s={superId:Object(a.b)("p_superId"),personaNoTaskId:this.groupSetId,personalNoTaskMessageSendContentList:this.reContentVal,sendTime:e,startTime:this.startTime,endTime:this.endTime};0===this.$route.query.error?Object(r.c)("/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){t.loading=!1,console.log(e),0===e.code?(t.$message({type:"success",message:"新增成功"}),t.agree=!1,t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"新增失败,请重试！！"}),t.agree=!1,t.reload())}):1===this.$route.query.error?Object(r.c)("/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){t.loading=!1,console.log(e),0===e.code?(t.$message({type:"success",message:"复制成功"}),t.agree=!1,t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"复制失败,请重试！！"}),t.agree=!1,t.reload())}):Object(r.c)("/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){t.loading=!1,console.log(e),0===e.code?(t.$message({type:"success",message:"修改成功"}),t.agree=!1,t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"修改失败，请重试!!"}),t.agree=!1,t.reload())})},sendCancel:function(){this.$router.push({path:"/taskMessageSend"}),this.reload()}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"newAddGroupSend"},[n("div",{staticClass:"adver-set"},[e._v("新增消息")]),e._v(" "),n("div",{staticClass:"adverWrapper"},[n("div",{staticClass:"adverBorder"},[n("el-form",{staticClass:"form"},[n("div",{staticClass:"send-wrapper"},[n("el-form-item",{attrs:{label:"群发任务:","label-width":"200px"}},[n("el-select",{staticStyle:{width:"200px",height:"40px","line-height":"40px"},attrs:{size:"small",filterable:"",placeholder:"请选择群发任务"},on:{change:function(t){return e.getProv1(t)}},model:{value:e.selectProv1,callback:function(t){e.selectProv1=t},expression:"selectProv1"}},e._l(e.provs,function(e,t){return n("el-option",{key:t,attrs:{label:e.taskName,value:e.id}})}),1)],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"开始时间&结束时间:","label-width":"200px"}},[n("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","default-time":["00:00:00","23:59:59"],"start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.startEndTime},model:{value:e.startOrEndTime,callback:function(t){e.startOrEndTime=t},expression:"startOrEndTime"}})],1),e._v(" "),n("div",{staticClass:"sendTs"},[n("el-form-item",{attrs:{label:"时间设置:","label-width":"200px"}},[n("el-radio-group",{on:{change:e.timeChange},model:{value:e.sendTiems,callback:function(t){e.sendTiems=t},expression:"sendTiems"}},[n("el-radio",{attrs:{label:"立即发送"}},[e._v("立即发送")]),e._v(" "),n("el-radio",{attrs:{label:"定时发送"}},[e._v("定时发送")])],1)],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.Dshow,expression:"Dshow"}]},[n("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:e.editSelectDate},model:{value:e.editDate2,callback:function(t){e.editDate2=t},expression:"editDate2"}}),e._v(" "),n("el-time-picker",{attrs:{format:"HH:mm:ss",placeholder:"选择时间"},on:{change:e.editSelectTimes},model:{value:e.editTimeXuan2,callback:function(t){e.editTimeXuan2=t},expression:"editTimeXuan2"}})],1)],1),e._v(" "),n("div",{staticClass:"invateGoGroup"},[n("el-form-item",{attrs:{label:"群裂变后台：","label-width":"150px"}},[n("el-select",{attrs:{placeholder:"请选择裂变后台"},on:{change:e.fssionChange},model:{value:e.fssion,callback:function(t){e.fssion=t},expression:"fssion"}},e._l(e.fssionList,function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),n("p",[e._v("*仅限邀请入群选择")])],1)],1),e._v(" "),n("div",{staticClass:"groupSendC"},[n("el-form-item",{attrs:{label:"发送内容:","label-width":"200px"}},[n("div",{staticClass:"newBigCon"},[n("div",{staticClass:"newTop"},[n("ul",[n("li",{staticStyle:{width:"105px"},on:{click:e.word}},[e._v("文字")]),e._v(" "),n("li",{on:{click:e.showImg}},[e._v("图片")]),e._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:!0===e.goP,expression:"goP === true"}],on:{"~click":function(t){return e.music(t)}}},[e._v("邀请入群")]),e._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:!1===e.goP,expression:"goP === false"}]},[e._v("邀请入群")]),e._v(" "),n("li",{on:{click:e.miniPro}},[e._v("小程序")]),e._v(" "),n("li",{on:{click:e.voiceInfo}},[e._v("语音消息")])])]),e._v(" "),n("div",{ref:"newBottom",staticClass:"newBottom"},[e._l(e.reContentVal,function(t,s){return n("div",{key:s,attrs:{draggable:"true"},on:{dragstart:function(s){return e.handleDragStart(s,t)},dragover:function(s){return s.preventDefault(),e.handleDragOver(s,t)},dragenter:function(s){return e.handleDragEnter(s,t)},dragend:function(s){return e.handleDragEnd(s,t)}}},["文字"===t.contentType?n("div",{ref:"word",refInFor:!0,staticClass:"newWords"},[n("i",{staticClass:"el-icon-edit"}),e._v(" "),n("el-input",{staticStyle:{height:"200px"},attrs:{type:"textarea",maxlength:"800",autosize:{minRows:5,maxRows:5},placeholder:"请输入回复内容，不得超过800字。添加“#####”可在回复时@对应成员。"},on:{change:function(n){return e.inputChange(t,n,s)}},model:{value:t.content,callback:function(s){e.$set(t,"content",s)},expression:"item.content"}}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"图片"===t.contentType?n("div",{ref:"image",refInFor:!0,staticClass:"newImg"},[n("i",{staticClass:"el-icon-picture-outline"}),e._v(" "),n("div",{staticClass:"uploadImg"},[n("span",[e._v(e._s(t.content))]),e._v(" "),n("input",{ref:"file",refInFor:!0,attrs:{type:"file",id:"file"},on:{change:function(t){return e.getFile(t)}}}),e._v(" "),n("label",{staticClass:"upload",attrs:{for:"file"},on:{click:function(t){return e.uploadImgs(s)}}},[e._v("上传文件")]),e._v(" "),n("label",{staticClass:"yulan",on:{click:function(n){return e.yulan(t.content,s)}}},[e._v("预览")])]),e._v(" "),n("el-dialog",{attrs:{visible:e.yulanEWM,width:"20%","append-to-body":""},on:{"update:visible":function(t){e.yulanEWM=t}}},[n("img",{staticClass:"imgWEM",attrs:{src:t.content}})]),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.goP,expression:"goP === false"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?n("span",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[n("i",{staticClass:"iconfont icon-yonghu-tianchong",staticStyle:{"padding-right":"10px"}}),e._v(e._s(e.relapyContentCategoryName))]):e._e()]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.goP,expression:"goP"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?n("div",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[n("i",{staticClass:"iconfont icon-yonghu-tianchong"}),e._v(" "),n("div",{staticClass:"groupList",staticStyle:{"margin-left":"20px"}},[n("el-select",{attrs:{placeholder:"请选择群类别集合"},on:{change:e.selectGroupSet},model:{value:e.groupSet,callback:function(t){e.groupSet=t},expression:"groupSet"}},e._l(e.groupCategorySet,function(e){return n("el-option",{key:e.sname,attrs:{label:e.sname,value:e.id}})}),1),e._v(" "),n("el-select",{attrs:{placeholder:"请选择群类别"},on:{change:function(t){return e.selectGroup(t,s)}},model:{value:e.groupV,callback:function(t){e.groupV=t},expression:"groupV"}},e._l(e.groupCategory,function(e){return n("el-option",{key:e.cname,attrs:{label:e.cname,value:e.id}})}),1)],1),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})]):e._e()]),e._v(" "),"小程序"===t.contentType?n("div",{ref:"little",refInFor:!0,staticClass:"newWords little"},[n("i",{staticClass:"el-icon-edit"}),e._v(" "),n("el-input",{staticStyle:{border:"none"},attrs:{placeholder:"请输入小程序链接地址"},on:{change:function(n){return e.inputChangeLittle(t,n,s)}},model:{value:t.content,callback:function(s){e.$set(t,"content",s)},expression:"item.content"}}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"语音消息"===t.contentType?n("div",{ref:"voice",refInFor:!0,staticClass:"newWords"},[n("i",{staticClass:"iconfont icon-yuyin"}),e._v(" "),n("div",{staticClass:"uploadVoice",staticStyle:{display:"flex","flex-direction":"row"}},[n("el-input",{attrs:{placeholder:"请输入个人号转过来的链接..."},on:{change:function(n){return e.uploadVoiceValShow(t,n,s)}},model:{value:t.content,callback:function(s){e.$set(t,"content",s)},expression:"item.content"}})],1),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",staticStyle:{right:"-20px"},on:{click:function(t){return e.close(s)}}})]):e._e()])}),e._v(" "),n("div",{staticClass:"fission"}),e._v(" "),n("span",{staticStyle:{color:"red"}},[e._v("每次发送不能超过5条消息")])],2)])])],1),e._v(" "),n("div",{staticClass:"submit"},[n("el-button",{staticClass:"subSpa1",attrs:{disabled:e.agree},on:{click:e.send}},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticStyle:{width:"16px",height:"16px","vertical-align":"middle"},attrs:{src:s("G/2H")}}),e._v("\n            发 送")]),e._v(" "),n("el-button",{staticClass:"subSpa2",on:{click:e.sendCancel}},[e._v("取 消")])],1)],1)],1)])])},staticRenderFns:[]};var d=s("C7Lr")(l,c,!1,function(e){s("UNAC"),s("36Xe")},"data-v-0b3de3ea",null);t.default=d.exports},UNAC:function(e,t){}});