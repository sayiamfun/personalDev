webpackJsonp([11],{IFYv:function(e,t){},IwXm:function(e,t){},ORkd:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("IHPB"),a=n.n(s),i=n("Y8t/"),o=n("T452"),l={name:"copyTagMessageSend",data:function(){return{startTime:"",endTime:"",friendsNum:0,groupV:"",groupCategory:[],groupSet:"",groupCategorySet:[],relapyContentCategoryName:"",yulanEWM:!1,indexTime:0,src:"",registerAvatar:"",duration:300,reContentVal:[{content:"",contentType:"文字"}],goP:!0,fssionIndex:0,fssion:"",fssionList:[{id:0,name:"1号后台"},{id:1,name:"2号后台"}],timeSettingModel:"",showSendTime:!1,sendTiems:"立即发送",isIndeterminates:!0,isicons:!0,isicon:!0,quDaoVal:"请选择标签",quDaoVal1:"请选择个人号",checkAll1:[],checkAlls:[],isIndeterminate:!0,startOrEndTime:"",lableModel:[],personalModel:[],lableCategoryModel:"",lableList:[],personaleList:[],lableCategoryList:[]}},created:function(){var e=this;Object(i.b)("/personalLableCategoryManager").then(function(t){e.lableCategoryList=t.data}).catch(function(t){e.$message({type:"error",message:t.message})}),1==this.$route.query.code&&Object(i.c)("/personalNoLableMessageSend/"+this.$route.query.id+"/").then(function(t){e.reContentVal=t.data.personalNoLableMessageSendContentList;for(var n=0;n<e.reContentVal.length;n++){if("邀请入群"===e.reContentVal[n].contentType){e.goP=!1;break}e.goP=!0}t.data.sendTime&&(e.sendTiems="定时发送",e.showSendTime=!0,e.timeSettingModel=t.data.sendTime,e.relapyContentCategoryName=t.data.groupName)}).catch(function(t){e.$message({type:"error",message:t.message})})},methods:{startEndTime:function(e){this.startTime=e[0],this.endTime=e[1]},labelCategoryChange:function(e){var t=this;Object(i.b)("/lableManager/getLableByCategory/"+e+"/").then(function(e){t.lableList=e.data,t.isicon=!1,t.quDaoVal="请选择标签",t.lableModel=[]}).catch(function(e){t.$message({type:"error",message:e.message})})},changeInput:function(e){this.isicon=!this.isicon},changeInputPersonal:function(){this.isicons=!this.isicons},handleCheckAllChange:function(e){!0===e?(this.quDaoVal="已选择"+this.lableList.length+"个",this.lableModel=this.lableList):(this.lableModel=[],this.quDaoVal="已选择0个"),this.isIndeterminate1=!1},handleCheckedCitiesChange:function(e){var t=this;this.lableModel=e,e.length,this.quDaoVal="已选择"+e.length+"个";var n=e.length;this.checkAll1=n===this.lableList.length,this.isIndeterminate1=n>0&&n<this.lableList.length;var s={lableList:e};Object(i.c)("/personalManager/listByLable",s).then(function(e){t.personaleList=e.data}).catch(function(e){t.$message({type:"error",message:e.message})})},handleCheckAllChanges:function(e){!0===e?(this.quDaoVal1="已选择"+this.lableList.length+"个",this.personalModel=this.personalList):(this.personalModel=[],this.quDaoVal1="已选择0个"),this.isIndeterminates=!1},handleCheckedCitiesChanges:function(e){var t=this;this.personalModel=e,e.length,this.quDaoVal1="已选择"+e.length+"个";var n={lableIdList:this.lableModel,noWxIdList:e};e.length>0?Object(i.c)("/personalNoLableMessageSend/getPeopleNum",n).then(function(e){t.friendsNum=e.data}).catch(function(e){t.$message({type:"error",message:e.message})}):this.$message({type:"error",message:"个人号为空了哦"})},timeChange:function(e){this.showSendTime="定时发送"===e},timeSettingChange:function(){},fssionChange:function(e){var t=this;0===e?(this.fssionIndex=0,this.fssion="1号后台"):(this.fssionIndex=1,this.fssion="2号后台"),Object(i.b)("/groupCategorySet/"+this.fssionIndex+"/").then(function(e){e.code===o.a?t.$message({type:"error",message:"暂时没有可用的群哦"}):t.groupCategorySet=e.data}).catch(function(e){t.$message({type:"error",message:e.message})})},word:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"文字",imageName:""}),this.$refs.newBottom.style.paddingTop=o.b+"px",this.$refs.newBottom.style.paddingBottom=o.b+"px"},showImg:function(){this.closeIgs=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"图片",imageName:""})},music:function(){!1===this.stopAddGroup?this.$message({type:"error",message:"邀请入群只能为一个"}):(this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"邀请入群"}),this.$refs.newBottom.style.paddingTop=o.b+"px",this.$refs.newBottom.style.paddingBottom=o.b+"px")},miniPro:function(){this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"小程序"}),this.$refs.newBottom.style.paddingTop=o.b+"px",this.$refs.newBottom.style.paddingBottom=o.b+"px"},voiceInfo:function(){this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"语音消息"})},handleDragStart:function(e,t){this.dragging=t},handleDragEnd:function(e,t){this.dragging=null},handleDragOver:function(e){e.dataTransfer.dropEffect="move"},handleDragEnter:function(e,t){if(e.dataTransfer.effectAllowed="move",t!==this.dragging){var n=[].concat(a()(this.reContentVal)),s=n.indexOf(this.dragging),i=n.indexOf(t);n.splice.apply(n,[i,0].concat(a()(n.splice(s,1)))),this.reContentVal=n}},inputChange:function(e,t,n){this.$set(this.reContentVal,n,{content:t,contentType:"文字"})},close:function(e){this.reContentVal.splice(e,1),this.$refs.newBottom.style.paddingTop=o.a+"px",this.$refs.newBottom.style.paddingBottom=o.a+"px"},getFile:function(e){var t=this;t.duration=0;var n=e.target.files[0];if(e&&window.FileReader){var s=new FileReader;s.readAsDataURL(n),s.onloadend=function(){var e=this;t.src=this.result,t.$message({showClose:!0,message:"图片压缩中.....",duration:0}),Object(i.c)("/upload/imageUpload",t.src).then(function(n){n.code===o.a?e.$message({type:"error",message:"图片上传"+n.message}):(t.$message.closeAll(),t.$message({type:"success",message:"图片上传成功"}),t.registerAvatar=n.data,t.$set(t.reContentVal,t.indexTime,{content:n.data,contentType:"图片"}))}).catch(function(t){e.$message({type:"error",message:t.message})})}}},uploadImgs:function(e){this.indexTime=e},yulan:function(e,t){this.indexTime===t&&(this.showIig=e),this.yulanEWM=!this.yulanEWM},selectGroupSet:function(e){var t=this;Object(i.b)("/groupCategory/"+e+"/"+this.fssionIndex+"/").then(function(e){e.code===o.a?t.$message({type:"error",message:"暂时没有群类别哦，创建一个群类别再来添加群哦"}):t.groupCategory=e.data}).catch(function(e){t.$message({type:"error",message:e.message})})},selectGroup:function(e,t){var n=e;this.$set(this.reContentVal,t,{content:this.fssionIndex+"/"+n,contentType:"邀请入群"})},inputChangeLittle:function(e,t,n){this.$set(this.reContentVal,n,{content:t,contentType:"小程序"})},uploadVoiceValShow:function(e,t){this.$set(this.reContentVal,t,{content:e,contentType:"语音消息"})},sure:function(){var e=this;if(""==this.personalModel)this.$message({type:"error",message:"标签消息发送的个人号不能够为空哦"});else if(""==this.lableModel)this.$message({type:"error",message:"标签消息发送的标签不能够为空哦"});else if(""==this.reContentVal[0].content)this.$message({type:"error",message:"标签消息发送的内容不能够为空哦"});else{var t={sendTime:this.timeSettingModel,personalNoLableMessageSendContentList:this.reContentVal,noWxIdList:this.personalModel,lableList:this.lableModel,startTime:this.startTime,endTime:this.endTime};Object(i.c)("/personalNoLableMessageSend/lableMessageSend",t).then(function(t){t.code===o.a?e.$message({type:"error",message:t.message}):(e.$message({type:"success",message:t.message}),e.$router.push({path:"/tagMessageSend"}))}).catch(function(t){e.$message({type:"error",message:t.message})})}},detailsCancel:function(){this.$router.push({path:"/tagMessageSend"})}}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"copyTagMessageSend"},[n("el-form",[n("el-form-item",{attrs:{label:"开始时间&结束时间：","label-width":"200"}},[n("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","default-time":["00:00:00","23:59:59"],"start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.startEndTime},model:{value:e.startOrEndTime,callback:function(t){e.startOrEndTime=t},expression:"startOrEndTime"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"选择粉丝标签类别："}},[n("div",{staticClass:"xianzhiContent"},[n("el-select",{staticStyle:{width:"17%"},attrs:{placeholder:"请选择标签类别"},on:{change:e.labelCategoryChange},model:{value:e.lableCategoryModel,callback:function(t){e.lableCategoryModel=t},expression:"lableCategoryModel"}},e._l(e.lableCategoryList,function(e){return n("el-option",{key:e.categoryName,attrs:{label:e.categoryName,value:e.categoryName}})}),1),e._v(" "),n("span",{staticClass:"tuiguang",on:{click:e.changeInput}},[e._v(e._s(e.quDaoVal)),n("i",{class:!0===e.isicon?"el-icon-arrow-down":"el-icon-arrow-up"})]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.isicon,expression:"isicon === false"}],staticClass:"triangle_border_up"},[n("span")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.isicon,expression:"isicon === false"}],staticClass:"proChannel"},[n("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.lableModel,callback:function(t){e.lableModel=t},expression:"lableModel"}},e._l(e.lableList,function(t,s){return n("el-checkbox",{key:s,attrs:{title:t.lableName,label:t.lableId}},[e._v(e._s(t.lableName))])}),1)],1),e._v(" "),n("span",{staticClass:"tuiguang",on:{click:e.changeInputPersonal}},[e._v(e._s(e.quDaoVal1)),n("i",{class:!0===e.isicon?"el-icon-arrow-down":"el-icon-arrow-up"})]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.isicons,expression:"isicons === false"}],staticClass:"triangle_border_up",staticStyle:{left:"30px"}},[n("span")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.isicons,expression:"isicons === false"}],staticClass:"proChannel",staticStyle:{left:"0px"}},[n("el-checkbox-group",{on:{change:e.handleCheckedCitiesChanges},model:{value:e.personalModel,callback:function(t){e.personalModel=t},expression:"personalModel"}},e._l(e.personaleList,function(t,s){return n("el-checkbox",{key:s,attrs:{title:t.nickName,label:t.wxId,disabled:"正常"!=t.status}},[e._v(e._s(t.nickName))])}),1)],1),e._v(" "),n("span",{staticStyle:{color:"red"}},[e._v("当前覆盖好友数："+e._s(e.friendsNum)+" 人")])],1)]),e._v(" "),n("el-form-item",{attrs:{label:"时间设置："}},[n("el-radio-group",{on:{change:e.timeChange},model:{value:e.sendTiems,callback:function(t){e.sendTiems=t},expression:"sendTiems"}},[n("el-radio",{attrs:{label:"立即发送"}},[e._v("立即发送")]),e._v(" "),n("el-radio",{attrs:{label:"定时发送"}},[e._v("定时发送")])],1)],1),e._v(" "),n("el-form-item",{staticStyle:{"margin-left":"80px"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showSendTime,expression:"showSendTime"}]},[n("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},on:{change:e.timeSettingChange},model:{value:e.timeSettingModel,callback:function(t){e.timeSettingModel=t},expression:"timeSettingModel"}})],1)]),e._v(" "),n("el-form-item",{attrs:{label:"群裂变后台："}},[n("el-select",{attrs:{placeholder:"请选择裂变后台"},on:{change:e.fssionChange},model:{value:e.fssion,callback:function(t){e.fssion=t},expression:"fssion"}},e._l(e.fssionList,function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),n("p",{staticStyle:{display:"inline-block",color:"red","margin-left":"10px"}},[e._v("*仅限邀请入群选择")])],1),e._v(" "),n("el-form-item",{attrs:{label:"发送内容:"}},[n("div",{staticClass:"newBigCon"},[n("div",{staticClass:"newTop"},[n("ul",[n("li",{staticStyle:{width:"105px"},on:{click:e.word}},[e._v("文字")]),e._v(" "),n("li",{on:{click:e.showImg}},[e._v("图片")]),e._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:!0===e.goP,expression:"goP === true"}],on:{click:e.music}},[e._v("邀请入群")]),e._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:!1===e.goP,expression:"goP === false"}]},[e._v("邀请入群")]),e._v(" "),n("li",{on:{click:e.miniPro}},[e._v("小程序")]),e._v(" "),n("li",{on:{click:e.voiceInfo}},[e._v("语音消息")])])]),e._v(" "),n("div",{ref:"newBottom",staticClass:"newBottom"},[e._l(e.reContentVal,function(t,s){return n("div",{key:s,attrs:{draggable:"true"},on:{dragstart:function(n){return e.handleDragStart(n,t)},dragover:function(n){return n.preventDefault(),e.handleDragOver(n,t)},dragenter:function(n){return e.handleDragEnter(n,t)},dragend:function(n){return e.handleDragEnd(n,t)}}},["文字"===t.contentType?n("div",{ref:"word",refInFor:!0,staticClass:"newWords"},[n("i",{staticClass:"el-icon-edit"}),e._v(" "),n("el-input",{attrs:{type:"textarea",maxlength:"800",autosize:{minRows:10,maxRows:10},placeholder:"请输入回复内容，不得超过800字。添加“#####”可在回复时@对应成员。"},on:{change:function(n){return e.inputChange(t,n,s)}},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"item.content"}}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"图片"===t.contentType?n("div",{ref:"image",refInFor:!0,staticClass:"newImg"},[n("i",{staticClass:"el-icon-picture-outline"}),e._v(" "),n("div",{staticClass:"uploadImg"},[n("span",[e._v(e._s(t.content))]),e._v(" "),n("input",{ref:"file",refInFor:!0,attrs:{type:"file",id:"file"},on:{change:function(t){return e.getFile(t)}}}),e._v(" "),n("label",{staticClass:"upload",attrs:{for:"file"},on:{click:function(t){return e.uploadImgs(s)}}},[e._v("上传文件")]),e._v(" "),n("label",{staticClass:"yulan",on:{click:function(n){return e.yulan(t.content)}}},[e._v("预览")])]),e._v(" "),n("el-dialog",{attrs:{visible:e.yulanEWM,width:"20%","append-to-body":""},on:{"update:visible":function(t){e.yulanEWM=t}}},[n("img",{staticClass:"imgWEM",attrs:{src:t.content}})]),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.goP,expression:"goP === false"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?n("span",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[n("i",{staticClass:"iconfont icon-yonghu-tianchong",staticStyle:{"padding-right":"10px"}}),e._v(e._s(e.relapyContentCategoryName))]):e._e()]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.goP,expression:"goP"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?n("div",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[n("i",{staticClass:"iconfont icon-yonghu-tianchong"}),e._v(" "),n("div",{staticClass:"groupList",staticStyle:{"margin-left":"20px"}},[n("el-select",{attrs:{placeholder:"请选择群类别集合"},on:{change:e.selectGroupSet},model:{value:e.groupSet,callback:function(t){e.groupSet=t},expression:"groupSet"}},e._l(e.groupCategorySet,function(e){return n("el-option",{key:e.sname,attrs:{label:e.sname,value:e.id}})}),1),e._v(" "),n("el-select",{attrs:{placeholder:"请选择群类别"},on:{change:function(t){return e.selectGroup(t,s)}},model:{value:e.groupV,callback:function(t){e.groupV=t},expression:"groupV"}},e._l(e.groupCategory,function(e){return n("el-option",{key:e.cname,attrs:{label:e.cname,value:e.id}})}),1)],1),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})]):e._e()]),e._v(" "),"小程序"===t.contentType?n("div",{ref:"little",refInFor:!0,staticClass:"newWords little",staticStyle:{height:"60px"}},[n("i",{staticClass:"el-icon-edit"}),e._v(" "),n("el-input",{staticStyle:{border:"none"},attrs:{placeholder:"请输入小程序链接地址"},on:{change:function(n){return e.inputChangeLittle(t,n,s)}},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"item.content"}}),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"语音消息"===t.contentType?n("div",{ref:"voice",refInFor:!0,staticClass:"newWords",staticStyle:{height:"60px"}},[n("i",{staticClass:"iconfont icon-yuyin"}),e._v(" "),n("div",{staticClass:"uploadVoice",staticStyle:{display:"flex","flex-direction":"row"}},[n("el-input",{staticStyle:{"margin-left":"10px"},attrs:{placeholder:"请输入个人号转过来的链接..."},on:{change:function(n){return e.uploadVoiceValShow(t,n,s)}},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"item.content"}})],1),e._v(" "),n("i",{staticClass:"el-icon-circle-close relative",staticStyle:{right:"-20px"},on:{click:function(t){return e.close(s)}}})]):e._e()])}),e._v(" "),n("div",{staticClass:"fission"}),e._v(" "),n("span",{staticStyle:{color:"red"}},[e._v("每次发送不能超过5条消息")])],2)])])],1),e._v(" "),n("div",{staticClass:"footer"},[n("span",{staticClass:"faqi",on:{click:e.sure}},[e._v("确 定")]),e._v(" "),n("span",{staticClass:"quxiao",on:{click:e.detailsCancel}},[e._v("取 消")])])],1)},staticRenderFns:[]};var c=n("C7Lr")(l,r,!1,function(e){n("IwXm"),n("IFYv")},"data-v-ac0be850",null);t.default=c.exports}});