webpackJsonp([26],{"BN+n":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("IHPB"),a=s.n(n),o=s("T452"),i=s("8EyE"),r=s("Y8t/"),l={name:"newAddGroupSend",data:function(){return{dragging:[],relapyContentCategoryName:"",stopAddGroup:!0,fssionIndex:0,fssionList:[{id:0,name:"1号后台"},{id:1,name:"2号后台"}],fssion:"",groupV:"",groupCategory:[],groupSet:"",groupCategorySet:[],goP:!0,startOrEndTime:"",agree:!1,reContentVal:[{content:"",contentType:"文字"}],loading:!1,selectProv1:"",provs:[],selectCity1:[],citys1:[],sendTiems:"立即发送",groupNei:"群发送",yulanEWM:!1,yulanEWMs:!1,Dshow:!1,dada1:"",titi1:"",upLoadVal:"",upLoadVals:"",replayNeiRong:"",editDate2:"",editTimeXuan2:"",src:"",srcs:"",startTime:"",endTime:"",mingCard:"",addLinks:""}},inject:["reload"],created:function(){var e=this;if(Object(r.b)("/personal/noTask").then(function(t){e.provs=t.data}).catch(function(t){e.$message({type:"error",message:t.message})}),1===this.$route.query.error?this.stopAddGroup=!1:this.stopAddGroup=!0,2===this.$route.query.error||1===this.$route.query.error){Object(r.c)("/personalNoTaskMessageSend/"+this.$route.query.id+"/",{}).then(function(t){var s=t.data;if(e.reContentVal=t.data.personalNoTaskMessageSendContentList,t.data.personalNoTaskMessageSendContentList.length>0)for(var n=0;n<t.data.personalNoTaskMessageSendContentList.length;n++)"邀请入群"===t.data.personalNoTaskMessageSendContentList[n].contentType?e.goP=!1:e.goP=!0;else e.goP=!0;e.selectProv1=s.personaNoTaskId,e.groupSetId=s.personaNoTaskId,e.relapyContentCategoryName=s.groupName}).catch(function(t){e.$message({type:"error",message:t.message})})}},methods:{handleDragStart:function(e,t){this.dragging=t},handleDragEnd:function(e,t){this.dragging=null},handleDragOver:function(e){e.dataTransfer.dropEffect="move"},handleDragEnter:function(e,t){if(e.dataTransfer.effectAllowed="move",t!==this.dragging){var s=[].concat(a()(this.reContentVal)),n=s.indexOf(this.dragging),o=s.indexOf(t);s.splice.apply(s,[o,0].concat(a()(s.splice(n,1)))),this.reContentVal=s}},fssionChange:function(e){var t=this;0===e?(this.fssionIndex=0,this.fssion="1号后台"):(this.fssionIndex=1,this.fssion="2号后台"),Object(r.b)("/groupCategorySet/"+this.fssionIndex+"/").then(function(e){e.code===o.a?t.$message({type:"error",message:"暂时没有可用的群哦"}):t.groupCategorySet=e.data}).catch(function(e){t.$message({type:"error",message:e.message})})},selectGroupSet:function(e){var t=this;Object(r.b)("/groupCategory/"+e+"/"+this.fssionIndex+"/").then(function(e){e.code===o.a?t.$message({type:"error",message:"暂时没有群类别哦，创建一个群类别再来添加群哦"}):t.groupCategory=e.data}).catch(function(e){t.$message({type:"error",message:e.message})})},selectGroup:function(e,t){var s=e;this.$set(this.reContentVal,t,{content:this.fssionIndex+"/"+s,contentType:"邀请入群"})},inputChangeLittle:function(e,t,s){this.$set(this.reContentVal,s,{content:t,contentType:"小程序"})},uploadVoiceValShow:function(e,t){this.$set(this.reContentVal,t,{content:e,contentType:"语音消息"})},startEndTime:function(e){this.startTime=e[0],this.endTime=e[1]},editSelectDate:function(e){var t=new Date(e),s=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var a=t.getDate()<10?"0"+t.getDate():t.getDate();this.dada1=s+"-"+n+"-"+a},editSelectTimes:function(e){var t=new Date(e),s=t.getHours()<10?"0"+t.getHours():t.getHours(),n=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),a=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();this.titi1=s+":"+n+":"+a},getProv1:function(e){this.groupSetId=e},timeChange:function(e){"定时发送"===e?(this.Dshow=!0,this.sendTiems=e):(this.Dshow=!1,this.sendTiems=e,this.dada1="",this.titi1="")},getFile:function(e){var t=this,s=e.target.files[0];if(e&&window.FileReader){var n=new FileReader;n.readAsDataURL(s),n.onloadend=function(){var e=this;t.src=this.result,t.$message({showClose:!0,message:"图片压缩中.....",duration:0}),Object(r.c)("/upload/imageUpload",t.src).then(function(s){s.code===o.a?e.$message({type:"error",message:"图片上传"+s.message}):(t.$message.closeAll(),t.$message({type:"success",message:"图片上传成功"}),t.registerAvatar=s.data,t.$set(t.reContentVal,t.indexTime,{content:s.data,contentType:"图片"}))}).catch(function(t){e.$message({type:"error",message:t.message})})}}},uploadImgs:function(e){this.indexTime=e},yulan:function(e,t){this.indexTime===t&&(this.showIig=e),this.yulanEWM=!this.yulanEWM},NeiSong:function(e){this.groupNei=e},inputChange:function(e,t,s){this.$set(this.reContentVal,s,{content:t,contentType:"文字"})},word:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"文字"}),this.$refs.newBottom.style.paddingTop=o.b+"px",this.$refs.newBottom.style.paddingBottom=o.b+"px"},busCard:function(){this.closeId=!0},showImg:function(){this.closeIgs=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"图片"})},music:function(){if(this.groupCategorySet.length<=0)this.$message({type:"error",message:"请先选择群裂变后台，在选择邀请入群操作"});else{for(var e=0,t=0;t<this.reContentVal.length;t++)"邀请入群"===this.reContentVal[t].contentType&&(e+=1);e>=1?this.$message({type:"error",message:"邀请入群只能为一个"}):(this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"邀请入群"}),this.$refs.newBottom.style.paddingTop=o.b+"px",this.$refs.newBottom.style.paddingBottom=o.b+"px")}},miniPro:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"小程序"}),this.$refs.newBottom.style.paddingTop=o.b+"px",this.$refs.newBottom.style.paddingBottom=o.b+"px"},voiceInfo:function(){this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"语音消息"})},link:function(){this.closeLinks=!0},goGroup:function(){},close:function(e){this.closeShow=!this.closeShow,this.reContentVal.splice(e,1),this.$refs.newBottom.style.paddingTop=o.a+"px",this.$refs.newBottom.style.paddingBottom=o.a+"px"},closeCard:function(){this.closeId=!this.closeId},closeImg:function(){this.closeIgs=!this.closeIgs},closeLink:function(){this.closeLinks=!this.closeLinks},send:function(){var e,t=this,s={};if(""==this.selectProv1)this.$message({type:"error",message:"请选择你要发送消息的任务"});else if(""==this.reContentVal[0].content)this.$message({type:"error",message:"任务消息发送的内容不能够为空哦"});else{if(e=""===this.dada1&&""===this.titi1?"":this.dada1+" "+this.titi1,2===this.$route.query.error)s={id:this.$route.query.id,personaNoTaskId:this.groupSetId,personalNoTaskMessageSendContentList:this.reContentVal,sendTime:e,startTime:this.startTime,endTime:this.endTime};else s={superId:Object(i.b)("p_superId"),personaNoTaskId:this.groupSetId,personalNoTaskMessageSendContentList:this.reContentVal,sendTime:e,startTime:this.startTime,endTime:this.endTime};0===this.$route.query.error?Object(r.c)("/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){0===e.code?(t.$message({type:"success",message:"新增成功"}),t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"新增失败,请重试！！"}),t.agree=!1,t.reload())}).catch(function(e){t.$message({type:"error",message:e.message})}):1===this.$route.query.error?Object(r.c)("/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){0===e.code?(t.$message({type:"success",message:"复制成功"}),t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"复制失败,请重试！！"}),t.reload())}).catch(function(e){t.$message({type:"error",message:e.message})}):Object(r.c)("/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){0===e.code?(t.$message({type:"success",message:"修改成功"}),t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"修改失败，请重试!!"}),t.reload())}).catch(function(e){t.$message({type:"error",message:e.message})})}},sendCancel:function(){this.$router.push({path:"/taskMessageSend"}),this.reload()}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"newAddGroupSend"},[s("div",{staticClass:"adver-set"},[e._v("新增消息")]),e._v(" "),s("div",{staticClass:"adverWrapper"},[s("div",{staticClass:"adverBorder"},[s("el-form",{staticClass:"form"},[s("div",{staticClass:"send-wrapper"},[s("el-form-item",{attrs:{label:"群发任务:","label-width":"200px"}},[s("el-select",{staticStyle:{width:"200px",height:"40px","line-height":"40px"},attrs:{size:"small",filterable:"",placeholder:"请选择群发任务"},on:{change:function(t){return e.getProv1(t)}},model:{value:e.selectProv1,callback:function(t){e.selectProv1=t},expression:"selectProv1"}},e._l(e.provs,function(e,t){return s("el-option",{key:t,attrs:{label:e.taskName,value:e.id}})}),1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"开始时间&结束时间:","label-width":"200px"}},[s("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","default-time":["00:00:00","23:59:59"],"start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.startEndTime},model:{value:e.startOrEndTime,callback:function(t){e.startOrEndTime=t},expression:"startOrEndTime"}})],1),e._v(" "),s("div",{staticClass:"sendTs"},[s("el-form-item",{attrs:{label:"时间设置:","label-width":"200px"}},[s("el-radio-group",{on:{change:e.timeChange},model:{value:e.sendTiems,callback:function(t){e.sendTiems=t},expression:"sendTiems"}},[s("el-radio",{attrs:{label:"立即发送"}},[e._v("立即发送")]),e._v(" "),s("el-radio",{attrs:{label:"定时发送"}},[e._v("定时发送")])],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.Dshow,expression:"Dshow"}]},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:e.editSelectDate},model:{value:e.editDate2,callback:function(t){e.editDate2=t},expression:"editDate2"}}),e._v(" "),s("el-time-picker",{attrs:{format:"HH:mm:ss",placeholder:"选择时间"},on:{change:e.editSelectTimes},model:{value:e.editTimeXuan2,callback:function(t){e.editTimeXuan2=t},expression:"editTimeXuan2"}})],1)],1),e._v(" "),s("div",{staticClass:"invateGoGroup"},[s("el-form-item",{attrs:{label:"群裂变后台：","label-width":"150px"}},[s("el-select",{attrs:{placeholder:"请选择裂变后台"},on:{change:e.fssionChange},model:{value:e.fssion,callback:function(t){e.fssion=t},expression:"fssion"}},e._l(e.fssionList,function(e){return s("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),s("p",{staticStyle:{color:"red"}},[e._v("*仅限邀请入群选择")])],1)],1),e._v(" "),s("div",{staticClass:"groupSendC"},[s("el-form-item",{attrs:{label:"发送内容:","label-width":"200px"}},[s("div",{staticClass:"newBigCon"},[s("div",{staticClass:"newTop"},[s("ul",[s("li",{staticStyle:{width:"105px"},on:{click:e.word}},[e._v("文字")]),e._v(" "),s("li",{on:{click:e.showImg}},[e._v("图片")]),e._v(" "),s("li",{on:{click:e.music}},[e._v("邀请入群")]),e._v(" "),s("li",{on:{click:e.miniPro}},[e._v("小程序")]),e._v(" "),s("li",{on:{click:e.voiceInfo}},[e._v("语音消息")])])]),e._v(" "),s("div",{ref:"newBottom",staticClass:"newBottom"},[e._l(e.reContentVal,function(t,n){return s("div",{key:n,attrs:{draggable:"true"},on:{dragstart:function(s){return e.handleDragStart(s,t)},dragover:function(s){return s.preventDefault(),e.handleDragOver(s,t)},dragenter:function(s){return e.handleDragEnter(s,t)},dragend:function(s){return e.handleDragEnd(s,t)}}},["文字"===t.contentType?s("div",{ref:"word",refInFor:!0,staticClass:"newWords"},[s("i",{staticClass:"el-icon-edit"}),e._v(" "),s("el-input",{staticStyle:{height:"200px"},attrs:{type:"textarea",maxlength:"800",autosize:{minRows:5,maxRows:5},placeholder:"请输入回复内容，不得超过800字。添加“#####”可在回复时@对应成员。"},on:{change:function(s){return e.inputChange(t,s,n)}},model:{value:t.content,callback:function(s){e.$set(t,"content",s)},expression:"item.content"}}),e._v(" "),s("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(n)}}})],1):e._e(),e._v(" "),"图片"===t.contentType?s("div",{ref:"image",refInFor:!0,staticClass:"newImg"},[s("i",{staticClass:"el-icon-picture-outline"}),e._v(" "),s("div",{staticClass:"uploadImg"},[s("span",[e._v(e._s(t.content))]),e._v(" "),s("input",{ref:"file",refInFor:!0,attrs:{type:"file",id:"file"},on:{change:function(t){return e.getFile(t)}}}),e._v(" "),s("label",{staticClass:"upload",attrs:{for:"file"},on:{click:function(t){return e.uploadImgs(n)}}},[e._v("上传文件")]),e._v(" "),s("label",{staticClass:"yulan",on:{click:function(s){return e.yulan(t.content,n)}}},[e._v("预览")])]),e._v(" "),s("el-dialog",{attrs:{visible:e.yulanEWM,width:"20%","append-to-body":""},on:{"update:visible":function(t){e.yulanEWM=t}}},[s("img",{staticClass:"imgWEM",attrs:{src:t.content}})]),e._v(" "),s("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(n)}}})],1):e._e(),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!1===e.goP,expression:"goP === false"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?s("span",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[s("i",{staticClass:"iconfont icon-yonghu-tianchong",staticStyle:{"padding-right":"10px"}}),e._v(e._s(e.relapyContentCategoryName))]):e._e()]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.goP,expression:"goP"}],staticStyle:{"margin-bottom":"10px"}},["邀请入群"===t.contentType?s("div",{ref:"goGroup",refInFor:!0,staticClass:"goGroup"},[s("i",{staticClass:"iconfont icon-yonghu-tianchong"}),e._v(" "),s("div",{staticClass:"groupList",staticStyle:{"margin-left":"20px"}},[s("el-select",{attrs:{placeholder:"请选择群类别集合"},on:{change:e.selectGroupSet},model:{value:e.groupSet,callback:function(t){e.groupSet=t},expression:"groupSet"}},e._l(e.groupCategorySet,function(e){return s("el-option",{key:e.sname,attrs:{label:e.sname,value:e.id}})}),1),e._v(" "),s("el-select",{attrs:{placeholder:"请选择群类别"},on:{change:function(t){return e.selectGroup(t,n)}},model:{value:e.groupV,callback:function(t){e.groupV=t},expression:"groupV"}},e._l(e.groupCategory,function(e){return s("el-option",{key:e.cname,attrs:{label:e.cname,value:e.id}})}),1)],1),e._v(" "),s("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(n)}}})]):e._e()]),e._v(" "),"小程序"===t.contentType?s("div",{ref:"little",refInFor:!0,staticClass:"newWords little"},[s("i",{staticClass:"el-icon-edit"}),e._v(" "),s("el-input",{staticStyle:{border:"none"},attrs:{placeholder:"请输入小程序链接地址"},on:{change:function(s){return e.inputChangeLittle(t,s,n)}},model:{value:t.content,callback:function(s){e.$set(t,"content",s)},expression:"item.content"}}),e._v(" "),s("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(n)}}})],1):e._e(),e._v(" "),"语音消息"===t.contentType?s("div",{ref:"voice",refInFor:!0,staticClass:"newWords"},[s("i",{staticClass:"iconfont icon-yuyin"}),e._v(" "),s("div",{staticClass:"uploadVoice",staticStyle:{display:"flex","flex-direction":"row"}},[s("el-input",{attrs:{placeholder:"请输入个人号转过来的链接..."},on:{change:function(s){return e.uploadVoiceValShow(t,s,n)}},model:{value:t.content,callback:function(s){e.$set(t,"content",s)},expression:"item.content"}})],1),e._v(" "),s("i",{staticClass:"el-icon-circle-close relative",staticStyle:{right:"-20px"},on:{click:function(t){return e.close(n)}}})]):e._e()])}),e._v(" "),s("div",{staticClass:"fission"}),e._v(" "),s("span",{staticStyle:{color:"red"}},[e._v("每次发送不能超过5条消息")])],2)])])],1),e._v(" "),s("div",{staticClass:"submit"},[s("el-button",{staticClass:"subSpa1",on:{click:e.send}},[e._v("发 送")]),e._v(" "),s("el-button",{staticClass:"subSpa2",on:{click:e.sendCancel}},[e._v("取 消")])],1)],1)],1)])])},staticRenderFns:[]};var d=s("C7Lr")(l,c,!1,function(e){s("E7Lq"),s("ydeJ")},"data-v-00580acc",null);t.default=d.exports},E7Lq:function(e,t){},ydeJ:function(e,t){}});