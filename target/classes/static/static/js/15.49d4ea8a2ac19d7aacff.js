webpackJsonp([15],{"BN+n":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("hUhi"),n=s("T452"),a=s("8EyE"),i={name:"newAddGroupSend",data:function(){return{startOrEndTime:"",agree:!1,reContentVal:[{content:"",contentType:"文字"}],loading:!1,selectProv1:"",provs:[],selectCity1:[],citys1:[],sendTiems:"立即发送",groupNei:"群发送",closeShow:!0,closeId:!1,closeIgs:!1,closeLinks:!1,checkedIn:!1,checkedAdd:!1,yulanEWM:!1,yulanEWMs:!1,Dshow:!1,dada1:"",titi1:"",upLoadVal:"",upLoadVals:"",replayNeiRong:"",editDate2:"",editTimeXuan2:"",src:"",srcs:"",startTime:"",endTime:"",mingCard:"",addLinks:""}},inject:["reload"],created:function(){var e=this;if(this.$http.get(n.d+"/personal/noTask").then(function(t){console.log(t),e.provs=Object(o.a)(t,e).body.data}),console.log(this.$route.query.error),2===this.$route.query.error||1===this.$route.query.error){this.$http.post(n.d+"/personalNoTaskMessageSend/"+this.$route.query.id+"/",{}).then(function(t){console.log(t);var s=t.body.data;if(e.reContentVal=t.body.data.personalNoTaskMessageSendContentList,e.selectProv1=s.personaNoTaskId,e.groupSetId=s.personaNoTaskId,console.log(s.sendTime),s.sendTime){e.Dshow=!0,e.sendTiems="定时发送",e.editDate2=s.sendTime,e.editTimeXuan2=s.sendTime;var o=s.sendTime.slice(0,10),n=s.sendTime.slice(10,-1);e.dada1=o,e.titi1=n}else e.Dshow=!1,e.sendTiems="立即发送",e.dada1="",e.titi1=""})}},methods:{startEndTime:function(e){console.log(e),this.startTime=e[0],this.endTime=e[1]},editSelectDate:function(e){console.log(e);var t=new Date(e),s=t.getFullYear(),o=t.getMonth()+1;o=o<10?"0"+o:o;var n=t.getDate()<10?"0"+t.getDate():t.getDate();console.log(s+"-"+o+"-"+n),this.dada1=s+"-"+o+"-"+n},editSelectTimes:function(e){console.log(e);var t=new Date(e),s=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),n=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();console.log(s+":"+o+":"+n),this.titi1=s+":"+o+":"+n},getProv1:function(e){console.log("集合groupSetId:"+e),this.groupSetId=e},timeChange:function(e){console.log(e),"定时发送"===e?(this.Dshow=!0,this.sendTiems=e):(this.Dshow=!1,this.sendTiems=e,this.dada1="",this.titi1="")},getFile:function(e){var t=this,s=e.target.files[0];if(console.log(this.$refs.file),e&&window.FileReader){var o=new FileReader;o.readAsDataURL(s),o.onloadend=function(){var e=this;t.src=this.result,console.log(t.src),t.$http.post(n.d+"/upload/imageUpload",t.src).then(function(s){console.log(s),s.body.code===n.a?e.$message({type:"error",message:"图片上传"+s.body.message}):(t.registerAvatar=s.body.data,t.$set(t.reContentVal,t.indexTime,{content:s.body.data,contentType:"图片"}))})},console.log(t.reContentVal)}},uploadImgs:function(e){console.log(e),this.indexTime=e},yulan:function(e,t){console.log(e),console.log(t),this.indexTime===t&&(this.showIig=e),this.yulanEWM=!this.yulanEWM},NeiSong:function(e){console.log(e),this.groupNei=e},inputChange:function(e,t,s){console.log(s),this.$set(this.reContentVal,s,{content:t,contentType:"文字"})},word:function(){this.closeShow=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"文字"}),this.$refs.newBottom.style.paddingTop=n.c+"px",this.$refs.newBottom.style.paddingBottom=n.c+"px"},busCard:function(){this.closeId=!0},showImg:function(){this.closeIgs=!0,this.reContentVal.length>4?this.$message({type:"error",message:"每次发送最多五条消息"}):this.reContentVal.push({content:"",contentType:"图片"})},link:function(){this.closeLinks=!0},goGroup:function(){},close:function(e){this.closeShow=!this.closeShow,this.reContentVal.splice(e,1),this.$refs.newBottom.style.paddingTop=n.a+"px",this.$refs.newBottom.style.paddingBottom=n.a+"px"},closeCard:function(){this.closeId=!this.closeId},closeImg:function(){this.closeIgs=!this.closeIgs},closeLink:function(){this.closeLinks=!this.closeLinks},send:function(){var e,t=this;this.loading=!0,this.agree=!0;var s={};(e=""===this.dada1&&""===this.titi1?"":this.dada1+" "+this.titi1,2===this.$route.query.error)?s={id:this.$route.query.id,personaNoTaskId:this.groupSetId,personalNoTaskMessageSendContentList:this.reContentVal,sendTime:e,startTime:this.startTime,endTime:this.endTime}:s={superId:Object(a.b)("p_superId"),personaNoTaskId:this.groupSetId,personalNoTaskMessageSendContentList:this.reContentVal,sendTime:e,startTime:this.startTime,endTime:this.endTime};0===this.$route.query.error?this.$http.post(n.d+"/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){t.loading=!1,console.log(e),0===e.body.code?(t.$message({type:"success",message:"新增成功"}),t.agree=!1,t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"新增失败,请重试！！"}),t.agree=!1,t.reload())}):1===this.$route.query.error?this.$http.post(n.d+"/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){t.loading=!1,console.log(e),0===e.body.code?(t.$message({type:"success",message:"复制成功"}),t.agree=!1,t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"复制失败,请重试！！"}),t.agree=!1,t.reload())}):this.$http.post(n.d+"/personalNoTaskMessageSend/taskMessageSend",s).then(function(e){t.loading=!1,console.log(e),0===e.body.code?(t.$message({type:"success",message:"修改成功"}),t.agree=!1,t.$router.push({path:"/taskMessageSend"}),t.reload()):(t.$message({type:"error",message:"修改失败，请重试!!"}),t.agree=!1,t.reload())})},sendCancel:function(){this.$router.push({path:"/taskMessageSend"}),this.reload()}}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"newAddGroupSend"},[o("div",{staticClass:"adver-set"},[e._v("新增消息")]),e._v(" "),o("div",{staticClass:"adverWrapper"},[o("div",{staticClass:"adverBorder"},[o("el-form",{staticClass:"form"},[o("div",{staticClass:"send-wrapper"},[o("el-form-item",{attrs:{label:"群发任务:","label-width":"200px"}},[o("el-select",{staticStyle:{width:"200px",height:"40px","line-height":"40px"},attrs:{size:"small",filterable:"",placeholder:"请选择群发任务"},on:{change:function(t){return e.getProv1(t)}},model:{value:e.selectProv1,callback:function(t){e.selectProv1=t},expression:"selectProv1"}},e._l(e.provs,function(e,t){return o("el-option",{key:t,attrs:{label:e.taskName,value:e.id}})}),1)],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"开始时间&结束时间:","label-width":"200px"}},[o("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","default-time":["00:00:00","23:59:59"],"start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.startEndTime},model:{value:e.startOrEndTime,callback:function(t){e.startOrEndTime=t},expression:"startOrEndTime"}})],1),e._v(" "),o("div",{staticClass:"sendTs"},[o("el-form-item",{attrs:{label:"时间设置:","label-width":"200px"}},[o("el-radio-group",{on:{change:e.timeChange},model:{value:e.sendTiems,callback:function(t){e.sendTiems=t},expression:"sendTiems"}},[o("el-radio",{attrs:{label:"立即发送"}},[e._v("立即发送")]),e._v(" "),o("el-radio",{attrs:{label:"定时发送"}},[e._v("定时发送")])],1)],1),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.Dshow,expression:"Dshow"}]},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:e.editSelectDate},model:{value:e.editDate2,callback:function(t){e.editDate2=t},expression:"editDate2"}}),e._v(" "),o("el-time-picker",{attrs:{format:"HH:mm:ss",placeholder:"选择时间"},on:{change:e.editSelectTimes},model:{value:e.editTimeXuan2,callback:function(t){e.editTimeXuan2=t},expression:"editTimeXuan2"}})],1)],1),e._v(" "),o("div",{staticClass:"groupSendC"},[o("el-form-item",{attrs:{label:"发送内容:","label-width":"200px"}},[o("div",{staticClass:"newBigCon"},[o("div",{staticClass:"newTop"},[o("ul",[o("li",{staticStyle:{width:"105px"},on:{click:e.word}},[e._v("文字")]),e._v(" "),o("li",{on:{click:e.showImg}},[e._v("图片")])])]),e._v(" "),o("div",{ref:"newBottom",staticClass:"newBottom"},[e._l(e.reContentVal,function(t,s){return o("div",{key:s},["文字"===t.contentType?o("div",{ref:"word",refInFor:!0,staticClass:"newWords"},[o("i",{staticClass:"el-icon-edit"}),e._v(" "),o("el-input",{attrs:{type:"textarea",maxlength:"800",autosize:{minRows:5,maxRows:5},placeholder:"请输入回复内容，不得超过800字。添加“#####”可在回复时@对应成员。"},on:{change:function(o){return e.inputChange(t,o,s)}},model:{value:t.content,callback:function(s){e.$set(t,"content",s)},expression:"item.content"}}),e._v(" "),o("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e(),e._v(" "),"图片"===t.contentType?o("div",{ref:"image",refInFor:!0,staticClass:"newImg"},[o("i",{staticClass:"el-icon-picture-outline"}),e._v(" "),o("div",{staticClass:"uploadImg"},[o("span",[e._v(e._s(t.imageName))]),e._v(" "),o("input",{ref:"file",refInFor:!0,attrs:{type:"file",id:"file"},on:{change:function(t){return e.getFile(t)}}}),e._v(" "),o("label",{staticClass:"upload",attrs:{for:"file"},on:{click:function(t){return e.uploadImgs(s)}}},[e._v("上传文件")]),e._v(" "),o("label",{staticClass:"yulan",on:{click:function(o){return e.yulan(t.content,s)}}},[e._v("预览")])]),e._v(" "),o("el-dialog",{attrs:{visible:e.yulanEWM,width:"20%","append-to-body":""},on:{"update:visible":function(t){e.yulanEWM=t}}},[o("img",{staticClass:"imgWEM",attrs:{src:t.content}})]),e._v(" "),o("i",{staticClass:"el-icon-circle-close relative",on:{click:function(t){return e.close(s)}}})],1):e._e()])}),e._v(" "),o("div",{staticClass:"fission"}),e._v(" "),o("span",{staticStyle:{color:"red"}},[e._v("每次发送不能超过5条消息")])],2)])])],1),e._v(" "),o("div",{staticClass:"submit"},[o("el-button",{staticClass:"subSpa1",attrs:{disabled:e.agree},on:{click:e.send}},[o("img",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticStyle:{width:"16px",height:"16px","vertical-align":"middle"},attrs:{src:s("G/2H")}}),e._v("\n            发 送")]),e._v(" "),o("el-button",{staticClass:"subSpa2",on:{click:e.sendCancel}},[e._v("取 消")])],1)],1)],1)])])},staticRenderFns:[]};var r=s("C7Lr")(i,l,!1,function(e){s("oxz6"),s("hP5I")},"data-v-3fc1ddda",null);t.default=r.exports},hP5I:function(e,t){},oxz6:function(e,t){}});